{% extends "layout.html" %}

{% block content %}
<div class="container mt-4">
    <h1>{{ _('Student Dashboard') }}</h1>
    
    <div class="row">
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    {{ _('My Language Practice') }}
                </div>
                <div class="card-body">
                    {% if language_practice %}
                    <h5 class="card-title">{{ language_practice.language }}</h5>
                    <p>
                        <strong>{{ _('Level') }}:</strong> {{ language_practice.proficiency_level }}<br>
                        <strong>{{ _('Availability') }}:</strong> {{ language_practice.availability }}<br>
                        <strong>{{ _('Interests') }}:</strong> {{ language_practice.interests }}
                    </p>
                    <a href="{{ url_for('main.language_setup') }}" class="btn btn-sm btn-outline-primary">{{ _('Edit Settings') }}</a>
                    {% else %}
                    <p class="text-muted">{{ _('You have not set up your language practice profile yet.') }}</p>
                    <a href="{{ url_for('main.language_setup') }}" class="btn btn-primary">{{ _('Set Up Now') }}</a>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    {{ _('My Guide') }}
                </div>
                <div class="card-body">
                    {% if guide %}
                    <h5 class="card-title">{{ guide.user.username }}</h5>
                    <p>
                        <strong>{{ _('Languages') }}:</strong> {{ guide.user.languages }}<br>
                        <strong>{{ _('Experience') }}:</strong> {{ guide.years_experience }} {{ _('years') }}<br>
                        <strong>{{ _('Specialization') }}:</strong> {{ guide.specialization }}
                    </p>
                    <a href="#" class="btn btn-sm btn-outline-success">{{ _('Contact Guide') }}</a>
                    {% else %}
                    <p class="text-muted">{{ _('You have not selected a guide yet.') }}</p>
                    
                    {% if language_practice %}
                    <h6>{{ _('Available Guides for') }} {{ language_practice.language }}:</h6>
                    {% if available_guides %}
                    <div class="list-group mt-2">
                        {% for guide in available_guides %}
                        <div class="list-group-item">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>{{ guide.user.username }}</strong><br>
                                    {{ _('Experience') }}: {{ guide.years_experience }} {{ _('years') }}
                                </div>
                                <a href="{{ url_for('main.select_guide', guide_id=guide.user_id) }}" class="btn btn-sm btn-primary">{{ _('Select') }}</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <p class="text-muted">{{ _('No guides available for') }} {{ language_practice.language }}.</p>
                    {% endif %}
                    {% else %}
                    <p class="text-muted">{{ _('Set up your language practice profile first.') }}</p>
                    {% endif %}
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    {{ _('Chat Groups') }}
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ chat_groups|length }} {{ _('Chat Groups') }}</h5>
                    
                    {% if chat_groups %}
                    <div class="list-group mt-2">
                        {% for group in chat_groups %}
                        <a href="{{ url_for('main.chat_detail', chat_id=group.id) }}" class="list-group-item list-group-item-action">
                            {{ group.name }} ({{ group.language }})
                            <small class="text-muted d-block">{{ _('Guide') }}: {{ group.guide.username }}</small>
                        </a>
                        {% endfor %}
                    </div>
                    {% else %}
                    <p class="text-muted">{{ _('You are not a member of any chat groups yet.') }}</p>
                    <p>{{ _('Your guide can add you to chat groups for language practice.') }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}