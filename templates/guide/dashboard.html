{% extends "layout.html" %}

{% block content %}
<div class="container mt-4">
    <h1>{{ _('Guide Dashboard') }}</h1>
    
    <div class="row">
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    {{ _('My Profile') }}
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ current_user.username }}</h5>
                    <p>
                        <strong>{{ _('Languages') }}:</strong> {{ current_user.languages }}<br>
                        <strong>{{ _('Experience') }}:</strong> {{ guide.years_experience }} {{ _('years') }}<br>
                        <strong>{{ _('Specialization') }}:</strong> {{ guide.specialization }}
                    </p>
                    <a href="{{ url_for('profile') }}" class="btn btn-sm btn-outline-primary">{{ _('Edit Profile') }}</a>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    {{ _('Chat Groups') }}
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ chat_groups|length }} {{ _('Chat Groups') }}</h5>
                    <p>{{ _('Manage your language learning groups') }}</p>
                    <a href="{{ url_for('create_chat_group') }}" class="btn btn-sm btn-outline-success">{{ _('Create New Group') }}</a>
                    
                    {% if chat_groups %}
                    <hr>
                    <div class="list-group mt-2">
                        {% for group in chat_groups %}
                        <a href="{{ url_for('chat_detail', chat_id=group.id) }}" class="list-group-item list-group-item-action">
                            {{ group.name }} ({{ group.language }})
                        </a>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    {{ _('My Students') }}
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ students|length }} {{ _('Students') }}</h5>
                    <p>{{ _('Students assigned to you for language learning') }}</p>
                    
                    {% if students %}
                    <div class="list-group mt-2">
                        {% for student_practice in students %}
                        <div class="list-group-item">
                            <strong>{{ student_practice.student.username }}</strong><br>
                            {{ _('Language') }}: {{ student_practice.language }}<br>
                            {{ _('Level') }}: {{ student_practice.proficiency_level }}
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <p class="text-muted">{{ _('No students assigned yet.') }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <div class="row mt-2">
        <div class="col-md-12">
            <div class="card mb-4">
                <div class="card-header bg-warning text-dark">
                    {{ _('Assigned Tours') }}
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ guided_tours|length }} {{ _('Tours Assigned') }}</h5>
                    
                    {% if guided_tours %}
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>{{ _('Tour Plan') }}</th>
                                    <th>{{ _('Tourist') }}</th>
                                    <th>{{ _('Dates') }}</th>
                                    <th>{{ _('Status') }}</th>
                                    <th>{{ _('Actions') }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for tour in guided_tours %}
                                <tr>
                                    <td>{{ tour.tour_plan.title }}</td>
                                    <td>{{ tour.tourist.username }}</td>
                                    <td>{{ tour.start_date.strftime('%d/%m/%Y') }} - {{ tour.end_date.strftime('%d/%m/%Y') }}</td>
                                    <td>
                                        {% if tour.status == 'pending' %}
                                        <span class="badge bg-warning">{{ _('Pending') }}</span>
                                        {% elif tour.status == 'confirmed' %}
                                        <span class="badge bg-success">{{ _('Confirmed') }}</span>
                                        {% elif tour.status == 'completed' %}
                                        <span class="badge bg-primary">{{ _('Completed') }}</span>
                                        {% elif tour.status == 'cancelled' %}
                                        <span class="badge bg-danger">{{ _('Cancelled') }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <a href="{{ url_for('tour_guide_detail', tour_id=tour.id) }}" class="btn btn-sm btn-outline-primary">{{ _('View Details') }}</a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <p class="text-muted">{{ _('No tours assigned yet.') }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}