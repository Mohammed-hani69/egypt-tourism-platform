{% extends "layout.html" %}

{% block content %}
    <div class="container mt-5">
        <h1 class="text-center mb-4">Explore Egyptian Attractions</h1>
        
        <!-- Filters -->
        <div class="row mb-4">
            <div class="col-md-6">
                <label for="region-filter" class="form-label">Filter by Region:</label>
                <select id="region-filter" class="form-select">
                    <option value="">All Regions</option>
                    {% for region in regions %}
                        <option value="{{ region.id }}" {% if selected_region == region.id %}selected{% endif %}>
                            {{ region.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-6">
                <label for="sort-filter" class="form-label">Sort by:</label>
                <select id="sort-filter" class="form-select">
                    <option value="name" {% if sort_by == 'name' %}selected{% endif %}>Name (A-Z)</option>
                    <option value="rating" {% if sort_by == 'rating' %}selected{% endif %}>Rating (High to Low)</option>
                </select>
            </div>
        </div>
        
        <!-- Attractions Map -->
        <div class="mb-4">
            <h3 class="mb-3">Map View</h3>
            <div id="attractions-map" style="height: 400px; width: 100%; border-radius: 10px;"></div>
        </div>
        
        <!-- Attractions List -->
        <div class="row mt-4">
            {% if attractions %}
                {% for attraction in attractions %}
                    <div class="col-md-4 mb-4">
                        <div class="card attraction-card h-100">
                            <img src="{{ attraction.image_url or 'https://source.unsplash.com/500x300/?egypt,' + attraction.name }}" class="card-img-top" alt="{{ attraction.name }}">
                            <div class="card-body">
                                <h5 class="card-title">{{ attraction.name }}</h5>
                                <p class="card-text small">{{ attraction.region.name }}</p>
                                <p class="card-text">{{ attraction.description[:100] }}{% if attraction.description|length > 100 %}...{% endif %}</p>
                                {% if attraction.ticket_price %}
                                    <p class="card-text"><strong>Ticket:</strong> {{ attraction.ticket_price }}</p>
                                {% endif %}
                            </div>
                            <div class="card-footer">
                                <a href="{{ url_for('attraction_detail', attraction_id=attraction.id) }}" class="btn btn-sm btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="col-12 text-center">
                    <p>No attractions found with the selected filters. Please try different filters.</p>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <!-- Google Maps JavaScript API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initAttractionsMap" async defer></script>
    <script src="{{ url_for('static', filename='js/maps.js') }}"></script>
{% endblock %}
